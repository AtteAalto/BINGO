{\rtf1\ansi\ansicpg1252\cocoartf1504\cocoasubrtf830
{\fonttbl\f0\fswiss\fcharset0 Helvetica;\f1\fnil\fcharset0 LucidaGrande;}
{\colortbl;\red255\green255\blue255;\red191\green191\blue191;}
{\*\expandedcolortbl;;\csgray\c79525;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid101\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid2}
{\list\listtemplateid3\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid201\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid3}
{\list\listtemplateid4\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid301\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid4}
{\list\listtemplateid5\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid401\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid5}
{\list\listtemplateid6\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{hyphen\}}{\leveltext\leveltemplateid501\'01\uc0\u8259 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid6}
{\list\listtemplateid7\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid601\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid7}
{\list\listtemplateid8\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid701\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid8}
{\list\listtemplateid9\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid801\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid9}
{\list\listtemplateid10\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid901\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid10}
{\list\listtemplateid11\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1001\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid11}
{\list\listtemplateid12\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1101\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid12}
{\list\listtemplateid13\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1201\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid13}
{\list\listtemplateid14\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1301\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid14}
{\list\listtemplateid15\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1401\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid15}
{\list\listtemplateid16\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1501\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid16}
{\list\listtemplateid17\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1601\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid17}
{\list\listtemplateid18\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1701\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid18}
{\list\listtemplateid19\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1801\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid19}
{\list\listtemplateid20\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid1901\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid20}
{\list\listtemplateid21\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{square\}}{\leveltext\leveltemplateid2001\'01\uc0\u9642 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid21}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}{\listoverride\listid3\listoverridecount0\ls3}{\listoverride\listid4\listoverridecount0\ls4}{\listoverride\listid5\listoverridecount0\ls5}{\listoverride\listid6\listoverridecount0\ls6}{\listoverride\listid7\listoverridecount0\ls7}{\listoverride\listid8\listoverridecount0\ls8}{\listoverride\listid9\listoverridecount0\ls9}{\listoverride\listid10\listoverridecount0\ls10}{\listoverride\listid11\listoverridecount0\ls11}{\listoverride\listid12\listoverridecount0\ls12}{\listoverride\listid13\listoverridecount0\ls13}{\listoverride\listid14\listoverridecount0\ls14}{\listoverride\listid15\listoverridecount0\ls15}{\listoverride\listid16\listoverridecount0\ls16}{\listoverride\listid17\listoverridecount0\ls17}{\listoverride\listid18\listoverridecount0\ls18}{\listoverride\listid19\listoverridecount0\ls19}{\listoverride\listid20\listoverridecount0\ls20}{\listoverride\listid21\listoverridecount0\ls21}}
\paperw11900\paperh16840\margl1440\margr1440\vieww12300\viewh8400\viewkind0
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\qc\partightenfactor0

\f0\b\fs28 \cf0 \ul \ulc0 Gene regulatory network inference method BINGO
\fs24 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
General:\
\

\b0 \ulnone The BINGO (Bayesian Inference of Networks with Gaussian prOcess dynamical models) method assumes that the discrete time series data is sampled from a continuous time trajectory 
\i x
\i0 , satisfying 
\i dx/dt = f(x) + u
\i0 . The function 
\i f
\i0  is modelled as a Gaussian process (GP) and the network structure is encoded in the hyperparameters of the covariance of the GP. The mean of the 
\i i
\i0 ^th component of 
\i f
\i0  is 
\i m_i(x) = b_i - a_i*x_i
\i0 . The method is introduced in the paper\
\
A. Aalto, L. Viitasaari, P. Ilmonen, L. Mombaerts & J. Goncalves. \'93Continuous time Gaussian process dynamical models in gene regulatory network inference\'94 arXiv:1808.09161, 2018.\
\
The method is based on MCMC sampling, meaning that it collects a large number of network samples. If a particular link appears in 60% of the samples, that is the posterior probability for the existence of that link, given the data and the underlying assumptions. It is recommended that at least 5000 samples is collected. Nine out of ten samples are discarded (thinning), so that 5000 samples requires 50000 iterations. It is possible to run a smaller amount of iterations in the beginning to check that the sampler works, and then run more samples. Sampling is fairly slow even for small systems, but the computation time scaling is rather good as the dimension grows.
\b \ul \
\
\
Basic use:
\b0 \ulnone \
\
The code consists of two main functions, BINGO_init, that initialises the MCMC sampler and does some data processing. The sampling is done in the function BINGO. The inputs to this function are the data, given as a matlab structure as described below, the state of the sampler (initialised by BINGO_init), and the sampling parameters (initialised by the BINGO_init, more information below). The output of the function consists of a matrix 
\i Plink
\i0 , which is an 
\i n
\i0  x 
\i n
\i0  matrix where 
\i n
\i0  is the number of genes. An element (
\i i
\i0 ,
\i j
\i0 ) of the matrix 
\i Plink
\i0  tells the number of the collected network samples that contain the link 
\i j
\i0  \'97> 
\i i
\i0 . The function also returns the number of the collected samples, which is called 
\i chain
\i0 . The posterior probabilities of links are obtained by dividing 
\i Plink/chain
\i0 . The output variable 
\i xstore
\i0  contains the posterior mean of the continuous trajectory. The output variable 
\i state
\i0  contains the current state of the sampler (needed if the sampling is continued, for example). The output variable 
\i stats
\i0  contains statistics of the MCMC sampling, which are also displayed in the command window after the sampling is finished.\
\
The main file (BINGO_main) used for running the simulations contains first a burn-in, that is, running the sampler for a while and discarding all the samples. Then it contains a sampling part, and finally a part continuing the sampling process. This makes it possible to run some iterations first to get some idea, and then continue the sampling to improve the results. Notice that the method is also easily parallelisable. Just run the method on different processors, and in the end, sum up the 
\i Plink
\i0  matrices. A simple example dataset is provided together with an example file (BINGO_example) where the various functionalities of the method (described below in this document) are presented.\
\
\

\b \ul WARNING!
\b0 \ulnone \
\
In the data pre-processing (in the file BINGO_init), the time series data is scaled and moved so that the minimum value of each variable is 0 and the maximum is 1. This scaling is equivalent to giving scale-dependent priors to the hyperparameters beta. However, if the data contains genes that are not really expressed and contain only noise, this scaling leads to noise amplification. Therefore, the data should be checked and selected beforehand, and genes that are not at all expressed should be discarded. If, however, a gene is expressed in one experiment, and not in another, then it should be kept. Reducing the number of genes will also speed up the algorithm.\
\
\

\b\fs28 \ul Data:
\b0\fs24 \ulnone \
\
The data is given in a Matlab structure called 
\i data
\i0 . The time series data is included as a cell field 
\i data.ts
\i0  containing different experiments. Each cell corresponds to one experiment, and should consist of a matrix whose number of rows is the number of genes, and the number of columns is the number of time points in that experiment.\
\
\ul Example:\ulnone \
\
Number of genes is 
\i n
\i0 . Two experiments have been conducted with 
\i m1
\i0  time points in the first experiment, and 
\i m2
\i0  time points in the second experiment. The data is in matrices 
\i y1 
\i0 (
\i n 
\i0 x
\i  m1
\i0 ) and 
\i y2 
\i0 (
\i n 
\i0 x
\i  m2
\i0 ). Then the 
\i data.ts
\i0  field is generated as follows:\
\

\i data.ts = \{y1 , y2\};
\i0 \
\
\

\itap1\trowd \taflags1 \trgaph108\trleft-108 \trbrdrt\brdrnil \trbrdrl\brdrnil \trbrdrt\brdrnil \trbrdrr\brdrnil 
\clvertalt\clvertalbase \clshdrawnil \clbrdrt\brdrs\brdrw40\brdrcf2 \clbrdrl\brdrs\brdrw40\brdrcf2 \clbrdrb\brdrs\brdrw40\brdrcf2 \clbrdrr\brdrs\brdrw40\brdrcf2 \clpadl100 \clpadr100 \gaph\cellx8640
\pard\intbl\itap1\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 If your data is uniformly sampled, with no external input, no missing measurements, no prior knowledge of the network, and none of the time series correspond to knockout/knockdown experiments, you are good to go. If this is not the case, read further.\cell \lastrow\row
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\
\

\b \ul Sampling times:
\b0 \ulnone \
\
If the sampling times are not explicitly given by the user, uniform sampling (with sampling time 1) is assumed. If the sampling is not uniform (or if different sampling frequency is used in the different experiments), this can be specified in the cell field 
\i data.Tsam
\i0 . \
\
\ul Example:\ulnone \
Possible inputs for the cell field 
\i Tsam
\i0  are:\
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls1\ilvl0\cf0 {\listtext	
\f1 \uc0\u9642 
\f0 	}constant sampling time intervals (
\i dt
\i0 ) for all experiments: 
\i data.Tsam = \{dt\}
\i0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls2\ilvl0\cf0 {\listtext	
\f1 \uc0\u9642 
\f0 	}Different constant sampling time intervals (
\i dt1
\i0  and 
\i dt2
\i0 ) for the two experiments: 
\i data.Tsam = \{dt1 , dt2\};
\i0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls3\ilvl0\cf0 {\listtext	
\f1 \uc0\u9642 
\f0 	}Completely non-uniform sampling times: 
\i data.Tsam = \{[t1_1, t1_2 , \'85 , t1_m1] , [t2_1, t2_2 , \'85 , t2_m2]\}. 
\i0 In this case, the number of given time points must match the size of the corresponding measurement matrix.
\i \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls4\ilvl0
\i0 \cf0 {\listtext	
\f1 \uc0\u9642 
\f0 	}A combination of the two above: 
\i data.Tsam = \{[t1 , t2 , \'85 , tm1] , [dt2]\};
\i0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\ul Additional information:\ulnone \
The main function BINGO wants the field 
\i Tsam
\i0  in the format of a cell field where each cell has all the measurement times (corresponding to the case of completely non-uniform sampling). If the format is something else, then the initialisation file BINGO_init changes the format. However, if the user gives the sampling times in some other form, an error message will be displayed.\
\
\
\

\b \ul Explicit input (perturbations etc.):
\b0 \ulnone \
\
Explicit inputs can be given in the field 
\i data.input
\i0 . Its use is best explained through examples.\
\
\ul Example:\ulnone \
\
Say 
\i m1 
\i0 = 
\i m2 
\i0 = 8. Consider the following example cases:\
\
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls5\ilvl0\cf0 {\listtext	
\f1 \uc0\u9642 
\f0 	}1) The second experiment is a perturbation experiment, where some unknown perturbation is applied half way through the experiment. This kind of input is fed as follows:\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls6\ilvl0
\i \cf0 		data.input = \{zeros(1,8) , [0 0 0 0 1 1 1 1]\};
\i0 \
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls7\ilvl0\cf0 {\listtext	
\f1 \uc0\u9642 
\f0 	}2) Both experiments are perturbation experiments with two \ul different\ulnone  perturbations. This is given as follows:\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \

\i 	data.input = \{[0 0 0 0 1 1 1 1; zeros(1,8)] , [zeros(1,8); 0 0 0 0 1 1 1 1]\};
\i0 \
\
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls8\ilvl0\cf0 {\listtext	
\f1 \uc0\u9642 
\f0 	}3) Both experiments have the \ul same\ulnone  perturbation. This is given as follows:\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \

\i 	data.input = \{[0 0 0 0 1 1 1 1] , [0 0 0 0 1 1 1 1]\};\
\
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls9\ilvl0
\i0 \cf0 {\listtext	
\f1 \uc0\u9642 
\f0 	}4) In the first experiment, a perturbation is applied at time zero, and in the other experiment, there is no perturbation:\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \

\i 	data.input = \{ones(1,8) , zeros(1,8)\};\

\i0 \
\ul However\ulnone , if there is only one experiment with a perturbation applied at time zero, then an input of the form 
\i \{ones(1,8)\}
\i0  does not have any effect, and it should \ul not\ulnone  be included. In such case, assuming the system was in steady state before the perturbation, it is possible to duplicate the first measurement writing\
\

\i 	data.ts = \{[y(:,1) , y]\};
\i0 \
\
and then giving input\
\

\i 	data.input = \{[0 1 1 . . . 1]\};
\i0 \

\i \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls10\ilvl0
\i0 \cf0 {\listtext	
\f1 \uc0\u9642 
\f0 	}5) The input can also be a continuous variable, such as temperature:\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
	
\i data.input = \{[T1_1 , T1_2, \'85, T1_8] , [T2_1 , T2_2, \'85, T2_8]\};
\i0 \
\
and so on.\
\
When external input is given, the size of the output matrix 
\i Plink
\i0  is 
\i n
\i0  x (
\i n
\i0 +
\i n_in
\i0 ) where 
\i n_in
\i0  is the dimension of the input. The method also tells which genes does the perturbation affect directly. If the perturbation target is known, read the section \'93Prior knowledge of the network\'94 below.\
\
\ul Additional information:\ulnone \
The above warning concerns also external inputs. For example, if the temperature variation, and its effect on the process is negligible, then it should not be included as a possible input. \
\
\
\

\b \ul Missing measurements:
\b0 \ulnone \
\
If the measurement of some genes fail at some time points, this can be included in the information given to the method in a field 
\i data.missing
\i0 . Each cell in this field should be a matrix with size 
\i N_miss
\i0  x 2, where each row corresponds to a missing measurement of a gene. The first element on the row identifies the gene in question, and the second element tells the index of the time point where the measurement is missing. The values will be ignored in the method, so it does not matter what is the actual value of the element in the original data matrix.\
\
\ul Example:\ulnone \
\
Say the measurement of gene 2 failed at the 2nd and 3rd measurement times, and in the second experiment, the measurement of gene 3 failed in the 7th time point and the measurement of gene 5 failed in the first and fourth time points. This is given as follows:\
\

\i data.missing = \{[2 2; 2 3] , [3 7; 5 1; 5 4]\};
\i0 \
\
\ul Additional information:\
\ulnone Missing measurements are treated so that the Crank\'97Nicolson sampler draws Brownian bridge samples between the previous and next non-missing sample (corresponding precisely to the measurement model where the missing measurements are omitted). This is achieved by first replacing missing measurements by their linear interpolates (in the file BINGO_init), and then increasing the variance of the corresponding measurement noise in the BINGO file.\
\
\
\

\b \ul Prior knowledge of the network:
\b0 \ulnone \
\
If some links are certainly known to exist or not to exist, this information can be encoded in the field 
\i data.sure
\i0 . This should be an 
\i n
\i0  x 
\i n
\i0  matrix (or 
\i n
\i0  x (
\i n
\i0  + 
\i n_in
\i0 ) where 
\i n_in
\i0  is the input dimension if one also has prior knowledge on the targets of potential inputs) with ones in the positions indicating links that are known to exist, minus ones on the places known not to exist, and zeros elsewhere. Such prior information improves the results and speeds up the sampling as the number of candidate networks decreases.\
\
\ul Example:\ulnone \
\
In a 3 x 3 network, it is known for sure that gene 3 is a regulator of gene 1. In addition, there is one perturbation (external input) which is known to affect only gene 2. This is written as\
\

\i data.sure = [0 0 1 -1; 0 0 0 1; 0 0 0 -1];
\i0 \
\
\
\

\b \ul Knockout time series:
\b0 \ulnone \
\
If some time series correspond to gene knockout/knockdown experiments, then that time series should not be taken into account in the inference of links pointing to the knocked-out/down gene. Such information is included in the field 
\i data.ko
\i0 . For example, if there are four time series, and the third corresponds to an experiment where the second gene is knocked out and the fourth time series corresponds to an experiment where the fourth and fifth genes are knocked out, it is given as follows:\
\

\i data.ko = \{[ ] , [ ] , [2] , [4 5]\};
\i0 \
\
\
\

\b\fs28 \ul Method parameters
\b0\fs24 \ulnone \
\
Method parameters are given to the BINGO-function as a structure called 
\i parameters
\i0 . The values are set in the file BINGO_init, and it is not necessary to change these parameters, although it is advised that the user chooses a good value for the 
\i link_pr
\i0  parameter. The parameter fields are:\
\
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls11\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}link_pr
\i0 : The prior for networks is that the existence of each link is independent of others. If a link exists with (prior) probability 
\i p
\i0 , then 
\i link_pr
\i0  = 
\i p / (1-p)
\i0 . This parameter controls the level of sparsity in the network samples. This should be specified by the user. For example, if there are 50 nodes, and it is expected that each node has about 2-3 (incoming/outgoing) links, then one should set, for example, 
\i p
\i0  = 2.5 / 50. However, if the user does not provide the parameter, the default value is 
\i link_pr = 1/n
\i0 .\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls12\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}its
\i0 : number of iterations.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls13\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}nstep
\i0 : number of steps in the \'93continuous\'94 trajectory between the measurement times. Default value is 4. It can be reduced to 3 or even 2 if the sampling takes a very long time. If it is one, the method reduces to a kind of a discrete-time GPDM.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls14\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}Theur
\i0 : a temperature variable used in a heuristic scheme to speed up the topology sampling. If 
\i Theur
\i0  is one, it corresponds to exact sampling. Higher 
\i Theur
\i0  improves the acceptance probability of the topology sampling.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\
A number of different \ul step size parameters\ulnone  can be set by the user. Shorter step sizes increase the acceptance rates of the MCMC sampling, but it has a negative effect on the efficiency of the exploration of the parameter space. Note that hyperparameters gamma, beta, a, and b are sampled together. If their acceptance probability drops, either one or more of these can have too long step sizes. Similarly, the trajectory is sampled together with the noise variance q.\
\
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls15\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}etraj
\i0 : step size for the Crank\'97Nicolson sampler for the continuous trajectory. Default value is 0.15, and it is recommended that this is at least 0.1. It can be adjusted if the acceptation probability for the trajectory becomes low, which may happen if there are several experiments in the data.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls16\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}ea
\i0 : step size for sampling the 
\i a
\i0 -parameters in the mean function.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls17\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}eb
\i0 : step size for sampling the 
\i b
\i0 -parameters in the mean function.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls18\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}egamma
\i0 : step size for sampling the gamma-parameter in the GP covariance.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls19\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}ebeta
\i0 : step size for sampling the beta-parameter in the GP covariance.\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls20\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}er
\i0 : step size for sampling the measurement error variance 
\i r
\i0 .\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\pard\tx220\tx720\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\li720\fi-720\pardirnatural\partightenfactor0
\ls21\ilvl0
\i \cf0 {\listtext	
\f1\i0 \uc0\u9642 
\f0\i 	}eq
\i0 : step size for sampling the process noise covariance 
\i q
\i0 .\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0
\cf0 \
\
Not part of the 
\i parameters
\i0 -structure is 
\i nr_pi
\i0 , which is the number of pseudoinputs used in the GP regression in the code. Higher number improves accuracy, but slows down sampling.\
\
\
\

\b\fs28 \ul Troubleshooting
\b0\fs24 \ulnone \
\

\i Problem
\i0 : The acceptance probabilities for the trajectory and the topology are (almost) zero.\
\

\i Possible solutions
\i0 : The step size of the trajectory (
\i parameters.etraj
\i0 ) can be reduced, but it should not be below 0.1. It is possible that the initial value for the process noise covariance is too small. Try to increase it by changing it inside the file BINGO_init (
\i state.q
\i0 ). There is also a heuristic temperature variable (
\i parameters.Theur
\i0 ) which is one by default. It can be increased to about 1.5 to speed-up topology sampling. However, this method is heuristic, and then the sampling is not exactly what is claimed.\
\
\
\pard\tx566\tx1133\tx1700\tx2267\tx2834\tx3401\tx3968\tx4535\tx5102\tx5669\tx6236\tx6803\pardirnatural\partightenfactor0

\i \cf0 Problem
\i0 : The method is very slow.\
\

\i Possible solutions
\i0 : \
1) Consider parallelisation (see below).\
2) The gene expression trajectory is sampled on a finer grid where each measurement interval is divided into four parts (by default). This can be made coarser by changing 
\i nstep
\i0 =3 inside the function 
\i BINGO_init
\i0 .\
3) Number of pseudoinputs can be reduced inside 
\i BINGO_init
\i0  by setting 
\i nr_pi
\i0 =40 (for example, default is 50).\
4) Reduce dimension by throwing out genes whose expression data contains merely noise (which actually should be done anyway). \
5) If some genes are only interesting as potential regulators, they can be given to the method as inputs rather than as part of the time series data.\
\
\

\b \ul Parallelisation:
\b0 \ulnone \
\
1) Generate the 
\i data
\i0 -structure;\
\
parfor-loop\
	2) Run 
\i BINGO_init;
\i0 \
	3) The burn-in can be shortened by setting 
\i parameters.its
\i0 =1000 (for example, default is 3000);\
	4) Run 
\i BINGO 
\i0 with a suitable number of iterations;
\i \

\i0 	5) Store results;\
end\
\
6) Sum up the different 
\i Plink
\i0  matrices and divide by the total number of samples.\
\
}
